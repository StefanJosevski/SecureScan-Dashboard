package com.securescan.model;

import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.List;

public class AnalysisResult {

    public enum RiskLevel {
        SAFE("Safe", "#4CAF50"),
        SUSPICIOUS("Suspicious", "#FF9800"),
        MALICIOUS("Malicious", "#F44336");

        private final String label;
        private final String color;

        RiskLevel(String label, String color) {
            this.label = label;
            this.color = color;
        }

        public String getLabel() {
            return label;
        }

        public String getColor() {
            return color;
        }
    }

    private Email email;
    private int riskScore;
    private RiskLevel riskLevel;
    private List<PhishingIndicator> indicators;
    private LocalDateTime analysisDate;
    private String summary;

    public AnalysisResult(Email email) {
        this.email = email;
        this.indicators = new ArrayList<>();
        this.analysisDate = LocalDateTime.now();
    }

    public Email getEmail() {
        return email;
    }

    public int getRiskScore() {
        return riskScore;
    }

    public void setRiskScore(int riskScore) {
        this.riskScore = riskScore;
    }

    public RiskLevel getRiskLevel() {
        return riskLevel;
    }

    public void setRiskLevel(RiskLevel riskLevel) {
        this.riskLevel = riskLevel;
    }

    public List<PhishingIndicator> getIndicators() {
        return indicators;
    }

    public void setIndicators(List<PhishingIndicator> indicators) {
        this.indicators = indicators;
    }

    public LocalDateTime getAnalysisDate() {
        return analysisDate;
    }

    public String getSummary() {
        return summary;
    }

    public void setSummary(String summary) {
        this.summary = summary;
    }

    public RiskLevel calculateRiskLevel(int score) {
        if (score < 30) return RiskLevel.SAFE;
        if (score < 70) return RiskLevel.SUSPICIOUS;
        return RiskLevel.MALICIOUS;
    }

    @Override
    public String toString() {
        return "AnalysisResult{" +
                "riskScore=" + riskScore +
                ", riskLevel=" + riskLevel +
                ", indicators=" + indicators.size() +
                ", analysisDate=" + analysisDate +
                '}';
    }
}
